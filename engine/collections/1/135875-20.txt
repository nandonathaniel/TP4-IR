The RC4 stream cipher is used with a 128 - bit per - packet key , meaning that it dynamically generates a new key for each packet . This is used by WPA .