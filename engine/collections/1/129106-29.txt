Following the decisive Battle of Assandun on 18 October 1016 , King Edmund signed a treaty with Cnut in which all of England except for Wessex would be controlled by Cnut . Upon Edmund 's death on 30 November , Cnut ruled the whole kingdom as its sole king .