Fought in every major battle of Army of Northern Virginia , except Antietam .