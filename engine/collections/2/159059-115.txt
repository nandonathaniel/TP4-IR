Legal writers have failed to satisfactorily reconcile the bank 's undertaking with any contractual analysis . The theories include : the implied promise , assignment theory , the novation theory , reliance theory , agency theories , estoppels and trust theories , anticipatory theory and the guarantee theory .