Ted and Robin are now a couple ; meanwhile , a heartbroken Marshall tries to continue his life without Lily . After enduring numerous emotional breakdowns , Marshall 's friends step in , and Barney , using sly catchphrases and pick - up lines , tries to get Marshall back in the dating game . Later , Lily , after finally realizing she is not meant to be an artist , returns to New York . They remain separated as Marshall begins to date another girl , described by the gang as having ' crazy eyes ' . The date with the girl does not end well and eventually leads to Lily and Marshall becoming reunited , and their engagement eventually resumes . When Robin refuses to go to the mall or explain why , Marshall suspects she is married , and Barney suspects she has performed in adult films . They bet on it , appointing Lily as `` Slap Bet Commissioner . '' Lily oversees the search for the truth , as they discover that Robin was a teenage pop star named `` Robin Sparkles '' , and Marshall eventually earns the right to slap Barney five times whenever he wishes . He uses one slap immediately and another later in the season . It is revealed that Barney has a gay African American half - brother named James ( Wayne Brady ) and , unaware that his mother lied to him , believes that Bob Barker is his father . As a result of this he takes a trip to California to be a contestant on The Price Is Right to meet his `` father '' . While on the show , Barney wins all the prizes and gives them to Lily and Marshall as a ' happy early wedding ' present .