Derailments were minimized because of an early warning system that detected the earthquake before it struck . The system automatically stopped all high - speed trains , which minimized the damage .