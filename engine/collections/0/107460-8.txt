In one particular military usage , Cavalry Officer James Hewitt was declared persona non grata at his former barracks after he had revealed that he had slept with Diana , Princess of Wales .